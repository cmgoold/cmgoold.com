<p>What's so special about the cognitive
abilities of domestic dogs?
This has been a long-standing question,
perhaps <em>the</em> question,
since the boom of
dog behaviour and cognition research 25 to 30
years ago.
The obvious answer
is that dogs are highly attuned to read
and respond to
human behaviour on account of convergent
evolution with humans over some 15,000-plus 
years. Surely, the first
animal to be domesticated
has something to show
for their tolerance of human company
all those years?
This has come to be known as the
'domestication hypothesis'.
</p>

<p>A common experimental paradigm to test
whether domestic dogs have evolved abilities to
read human behaviour is the human pointing
study 
(for
instance, see 
<a href=https://link.springer.com/article/10.1007/s10071-005-0008-1>
    Mikl&oacutesi & Soproni, 2005</a>
or
<a href=https://www.researchgate.net/profile/Adam-Miklosi/publication/11438102_Dogs%27_Canis_familiaris_Responsiveness_to_Human_Pointing_Gestures/links/0046351965af1ef841000000/Dogs-Canis-familiaris-Responsiveness-to-Human-Pointing-Gestures.svg>
    Dorey et al. 2009</a>
or
<a href=https://onlinelibrary.wiley.com/doi/svg/10.1111/j.1469-185X.2009.00104.x?casa_token=FcLDxZQgoKsAAAAA%3APWpf3FyZu-FHiWGS9TbbQIyWhc4Wsgu8A2ix-WGKbvEI2vRh2wKGrTYXhBxaI7ro2lvEe7_HyL8Z>Udell, 2010</a>
or
<a href=https://journals.sagepub.com/doi/svg/10.1177/0963721416657540?casa_token=6rkWN-gRVl4AAAAA:bNCTW0-HNdOxxzwSOt9zuv6FHNzvp09D8jvW6_VWAPBg9v9uYyxXIvi4E_GinkWenX8O2z55iaY>Wynne, 2016</a>).
Dogs are placed in front of a human
who has containers of food to their
left and right. Over a number of trials,
humans point to different containers,
in a variety of ways,
and researchers test the hypothesis
that dogs follow the human point
more often than chance to the pointed-to
container.</p>

<p>Where this gets interesting is in
studies that compare dogs and wolves.
Wolves have generally 
performed worse than dogs in human
pointing studies (see, for example, 
<a href=https://link.springer.com/article/10.1007/s10071-007-0127-y>
    Vir&aacutenyi et al. 2008</a>)
and researchers have used these results to support
the hypothesis that dogs have evolved
specifically to live with humans and
follow their communicative signals.
But over the last 10 years, this has been
subject to a classic nature or nurture debate,
a question of, technically,
<em>phylogeny</em> or <em>ontogeny</em>.
Are dogs genetically-predisposed to perform
better at this task than wolves, or
can their superior performance be explained
by lifestyle factors that mean dogs
have more exposure to humans
than their wolf counterparts?</p>

<p>
Obviously, one would need to put dogs and
wolves on equal environmental footing to test
this hypothesis properly. But, that's not always
so easy to do, since facilities where
wolves and dogs have the exact same upbringing
are not plentiful, and dogs will at some stage
be placed in human homes where wolves will not.
These constraints on executing randomised
controlled trials, or not, is where good statistical
decisions are important.
</p>

<p>In 2023, 
<a href=https://link.springer.com/article/10.3758/s13420-022-00544-2>
    Wheat, Bijl & Wynne</a> 
re-analysed data
from 
<a href=https://www.cell.com/current-biology/fulltext/S0960-9822(21)00880-0?_returnURL=https%3A%2F%2Flinkinghub.elsevier.com%2Fretrieve%2Fpii%2FS0960982221008800%3Fshowall%3Dtrue>
    Salomons et al. (2021)</a>
who reported that hand-raised wolves
performed worse than dogs on a few different
standardised tests, including
a human pointing task.
The study also posited that while
the number of times subjects approached
familiar and unfamiliar people and
objects &mdash; referred to as <em>temperament</em>
during the study</em> &mdash; was positively associated
with point-following performance,
the relationship vanished when species
was included into the regression model.
The species effect was also no longer significant
when including both temperament and species
in the same model.
Wheat, Bijl & Wynne's re-analysis indicated
that the differences between wolves and
dogs in human point-following only emerged
in dogs after being homed with human
families at 8 weeks of age.
Wheat, Bilj & Wynne also re-fit
a model explaining point-following
performance with species and 
temperament as predictor variables.
They found no appreciable differences in
out-of-sample predictive accuracy using
Akaike's Information Criteria (AIC)
between models with or without species
and/or temperament as covariates.
</p>

<p>There's quite a lot to unpack here,
statistically, but it's helpful
and illuminating to place the results
under a causal lens.</p>

<p>The domestication hypothesis says that domestication
and, therefore, species
&mdash; dogs or wolves &mdash; has a direct causal
effect on point-following performance. 
According to Salomons et al. (2021),
species also influences a willingness
to approach unfamiliar humans or objects.
On the other hand,
in what I will call here the 'developmental'
hypothesis, dogs and wolves experience different rearing
conditions (i.e. exposure to humans), which influences
willingness to engage with humans and, ultimately,
point-following performance. Thus, the causal effect
of species is mediated by rearing experience and
willingness to approach. This is the 
crux of Wheat, Bilj & Wynne's argument.
</p>

<p>We can compare these hypotheses
visually using directed acyclic graphs, which could look
something like this, where P stands for
point-following performance, W represents
'willingness to approach strangers',
S is species, and R is the rearing environment.</p>

<svg class="dag">
    <defs>
        <marker id="arrow" viewBox="0 0 10 10" refX="5" refy="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
            <path d="M 0 0 L 10 5 L 0 10 z"/>
        </marker>
    </defs>

    <text x="0" y="15" font-size="18">
        Domestication hypothesis
    </text>
    <g transform="translate(10,20)">
        <text x="20" y="20">
            W
        </text>
        <text x="100" y="20">
            S
        </text>
        <text x="60" y="100">
            P
        </text>

        <!-- paths -->
        <line x1="95" x2="45" y1="15" y2="15" stroke-width="2" marker-end="url(#arrow)"/>
        <line x1="100" x2="70" y1="28" y2="75" stroke-width="2" marker-end="url(#arrow)"/>
    </g>

    <text x="275" y="15" font-size="18">
        Developmental hypothesis
    </text>
    <g transform="translate(300,20)">
        <text x="20" y="20">
            R
        </text>
        <text x="100" y="20">
            S
        </text>
        <text x="40" y="70">
            W
        </text>
        <text x="65" y="120">
            P
        </text>

        <!-- paths -->
        <line x1="95" x2="45" y1="15" y2="15" stroke-width="2" marker-end="url(#arrow)"/>
        <line x1="30" x2="38" y1="27" y2="45" stroke-width="2" marker-end="url(#arrow)"/>
        <line x1="52" x2="62" y1="75" y2="97" stroke-width="2" marker-end="url(#arrow)"/>
    </g>
</svg>

<p>In the domestication hypothesis, because species
is a common cause of both willingness to approach
strangers and point-following performance, any effect
of willingness to approach strangers should disappear
when species is conditioned upon.
To demonstrate this, I simulated data according to
the following simplified model of the domestication
hypothesis.
</p>

$$
\begin{align}
P_{i} &\sim \mathrm{Binomial}(n, \pi_{i})\\
\pi_{i} &= \mathrm{logit}^{-1}(\beta_{sp_{d}} S_{i} + \beta_{sp_{w}} (1 - S_{i}))\\
W_{i} &\sim \mathrm{Bernoulli}(\theta_{i})\\
\theta_i &= \mathrm{ilogit}^{-1}(
    \beta_{sw_{d}} S_i + \beta_{sw_{w}} (1 - S_i)
)\\
S_i &\sim \mathrm{Bernoulli}(0.5)
\end{align}
$$

<p>The index $i=1,...,N$ represents individual dogs,
$n$ is the number of trials of the point-following
task per dog, and $P$, $W$ and $S$ are as above.
I am ignoring control conditions and different
types of gestures here, and only imagining that dogs
receive $n$ trials of one point-following task on
which to gauge their performance.
I also assume that $S$ and $W$ are Bernoulli variables,
standing for wolves (0) or dogs (1) and 
no-approach (0) and approach (1),
respectively.
Here's what this data generating process looks like in
Python, choosing some values for the constants.</p>

<pre><code class="language-python hljs">
import numpy as np

SEED = 1234
rng = np.random.default_rng(SEED)

def ilogit(x: np.ndarray) -> np.ndarray:
    return np.array([
        1 / (1 + np.exp(-i))
        for i
        in x
    ])

N = 500
n = 6
b_sw_w = 0
b_sw_d = 3.5
b_sp_w = 0.5
b_sp_d = 1.3

S = rng.binomial(n=1, p=0.5, size=N)
theta = ilogit(b_sw_d * S + b_sw_w * (1 - S))
W = rng.binomial(n=1, p=theta)
pi = ilogit(b_sp_d * S + b_sp_w * (1 - S))
P = rng.binomial(n=n, p=pi)
</code></pre>

<p>I am setting <code>N=500</code> to ensure there is
a big enough sample size to estimate the effects of interest,
which assumes that on average there will be 250 dogs and 250 wolves.
This is considerably larger than Salomons et al.'s sample size.
The logit-scale probabilities of dogs and wolves approaching 
unfamiliar humans, <code>b_sw_d</code> and <code>b_sw_w</code>,
are set to match the results of 
Salomons et al. who reported a 30 fold increase in log odds
for dogs approach unfamiliar people compared to wolves.
Finally, the logit-scaled probabilities <code>b_sp_d</code>
and <code>b_sp_w</code> represent point-following success
per species, and are set to approximately 62% for wolves
and 78% for dogs, roughly matching the study's results.
</p>

<p>I then fit a binomial regression model similar
to the paper, with both species and willingness to approach
as predictors. 
One key difference is that the original authors
used a Bernoulli regression model with random effects per subject
to capture trial-level effects, but we don't need to worry about
that because we have no trial-level data.
Here's the model mathematically with weakly-informative priors.
<p>

$$
\begin{align}
    P_i &\sim \mathrm{Binomial}(n, \eta_i)\\
    \eta_i &= \mathrm{ilogit}^{-1}(
        \alpha + \beta_S (S_i - 0.5) + \beta_W (W_i - 0.5)
     )\\
     \alpha &\sim \mathrm{Normal}(0, 5)\\
     \beta_S &\sim \mathrm{Normal}(0, 1)\\
     \beta_W &\sim \mathrm{Normal}(0, 1)\\
\end{align}
$$

<p>I have used slightly different notation
to avoid conflating the parameters with the
true causal model. I have also made the Bernoulli
variables $S$ and $W$ take values $(-0.5, 0.5)$
to help the interpretation of $\alpha$ as close
to the average logit success.
Here's the model written and estimated in
PyMC.
</p>

<pre><code class="language-python hljs">
import pymc as pm

with pm.Model() as _:
    alpha = pm.Normal("alpha", mu=0, sigma=5)
    beta_S = pm.Normal("beta_S", mu=0, sigma=1)
    beta_W = pm.Normal("beta_W", mu=0, sigma=1)
    eta = pm.math.invlogit(
        alpha + 
        beta_S * (S - 0.5) +
        beta_W * (W - 0.5)
    )
    pm.Binomial("P", n=n, p=eta, observed=P)
    idata = pm.sample(1000, tune=1000, random_seed=rng)
</code></pre>

<p>This model returns the following posterior distributions 
of $\beta_{S}$ and $\beta_{W}$ on point-following performance,
along with the true, direct causal effects and the 94%
highest density intervals (HDIs).
</p>

<picture>
    <source srcset="/posts/dogs-causal-pointing/static/domestication-hypothesis-light.png" media="(prefers-color-scheme: light)"/>
    <source srcset="/posts/dogs-causal-pointing/static/domestication-hypothesis-dark.png" media="(prefers-color-scheme: dark)"/>
    <img src="/posts/dogs-causal-pointing/static/domestication-hypothesis-light.png"/>
    <figcaption>Posterior distributions of effects of species and willingness to approach, respectively, on point-following performance on data simulated from the domestication hypothesis.</figcaption>
</picture>

<p>As expected by the causal model, 
species is 'significant', in that its
HDI is clearly positive, and the effect of willingness
is close to zero. Note, however, in this particular simulation,
the estimation of $\beta_W$ is on average negative, which
will be important later.
Like Salomons et al. found, the effect of willingness
is therefore conditional upon species. 
However, unlike Salomons et al.,
species remains an important predictor of point-following, 
whereas the authors reported that the species
effect was curtailed in the combined 'species and willingness'
regression model.
This is not in support of the domestication hypothesis.
</p>

<p>
If separate regressions
for each predictor were run, the following results would be found.
</p>

<picture>
    <source srcset="/posts/dogs-causal-pointing/static/domestication-hypothesis-separate-light.png" media="(prefers-color-scheme: light)"/>
    <source srcset="/posts/dogs-causal-pointing/static/domestication-hypothesis-separate-dark.png" media="(prefers-color-scheme: dark)"/>
    <img src="/posts/dogs-causal-pointing/static/domestication-hypothesis-separate-light.png"/>
    <figcaption>Posterior distributions of effects of species and willingness to approach, respectively, on point-following performance from separate regression models and on data simulated from the domestication hypothesis.</figcaption>
</picture>

<p>As found in Salomons et al., both predictors are significant
when included without the other.</p>

<p>In their re-analysis, Wheat, Bilj & Wynne argued that
neither combined nor separate regression models could
be decided between because of their equivalent AIC values.
In the above models, the expected log predictive density, ELPD,
a measure of out-of-sample predictive accuracy and a
Bayesian analogue to AIC,
favours the first model, despite willingness in reality
having no causal effect. Why? Because the estimate
of $\beta_W$ in the first model, while not 'significant',
seems to have some small average, negative affect
on point-following performance, which in this instance
is just statistical noise. Optimising for predictive
accuracy does not necessarily align with causal
accuracy, and this highlights the dangers of
Wheat, Bilj & Wynne's focus on AIC values to provide
evidence for one or the other hypothesis.</p>


<p>Let's do the same for the developmental hypothesis.
If you're interested in the simulation code, you
can see it at the
<a href=https://github.com/cmgoold/cmgoold.com/blob/main/assets/posts/dogs-causal-pointing/code/>Github repository</a>.
First, here's the regression including both predictors.
</p>

<picture>
    <source srcset="/posts/dogs-causal-pointing/static/developmental-hypothesis-light.png" media="(prefers-color-scheme: light)"/>
    <source srcset="/posts/dogs-causal-pointing/static/developmental-hypothesis-dark.png" media="(prefers-color-scheme: dark)"/>
    <img src="/posts/dogs-causal-pointing/static/developmental-hypothesis-light.png"/>
    <figcaption>Posterior distributions of effects of species and willingness to approach, respectively, on point-following performance on data simulated on data simulated from the developmental hypothesis.</figcaption>
</picture>

<p>The effect of species is close to zero and the
effect of willingness is plausibly above zero, 
because willingness has a direct causal effect
on point-following.
Wheat, Bilj & Wynne say little about this in their
commentary, but if the developmental hypothesis
was correct, we'd expect an effect of willingness
to be present when conditioning on species,
not disappear as in the domestication
hypothesis.</p>

<p>Here are the results for the separate regressions.</p>

<picture>
    <source srcset="/posts/dogs-causal-pointing/static/developmental-hypothesis-separate-light.png" media="(prefers-color-scheme: light)"/>
    <source srcset="/posts/dogs-causal-pointing/static/developmental-hypothesis-separate-dark.png" media="(prefers-color-scheme: dark)"/>
    <img src="/posts/dogs-causal-pointing/static/developmental-hypothesis-separate-light.png"/>
    <figcaption>Posterior distributions of effects of species and willingness to approach, respectively, on point-following performance from separate regression models and on data simulated from the developmental hypothesis.</figcaption>
</picture>

<p>Now $\beta_S$ has a small but positive effect and
$\beta_W$ is also accurately estimated. The ELPD
values again slightly favour the combined regression
because of the small average,  non-zero effect of
species, despite the real causal effect being zero.</p>

<p>Finally, let's see what happens when we include
rearing experience, R, into the regression as well.</p>

<picture>
    <source srcset="/posts/dogs-causal-pointing/static/developmental-hypothesis-rearing-light.png" media="(prefers-color-scheme: light)"/>
    <source srcset="/posts/dogs-causal-pointing/static/developmental-hypothesis-rearing-dark.png" media="(prefers-color-scheme: dark)"/>
    <img src="/posts/dogs-causal-pointing/static/developmental-hypothesis-rearing-light.png"/>
    <figcaption>Posterior distributions of effects of species and willingness to approach, respectively, on point-following performance on data simulated from developmental hypothesis.</figcaption>
</picture>

<p>This model correctly indicates that species
and rearing experience have no direct causal
effect on point-following when conditioning
on willingness to approach, and clearly wins 
on ELPD.</p>

<p>To my knowledge, no-one has fit this model to
the original dataset.
Wheat, Bilj & Wynne found that rearing influenced
point-following in a model conditioning on only species,
which is expected by the developmental hypothesis causal
model, but the effect should disappear when conditioning
on willingness to approach. This would be a simple yet powerful
test of their hypothesis. If I have time, I will dig out the
original data.
</p>

<h3>Sample size and power</h3>

<p>Most canine cognition studies are underpowered
(<a href=https://journals.sagepub.com/doi/full/10.1177/0963721416667718?casa_token=yd2x6s40vVoAAAAA%3A-v7qR8R3cBRpBJ1QECPmCDye0IrFgnsag8bFtenZVxmqsLeWzEIXeeb6yUbFgY1akkNifV1TBfs>Ardens et al., 2016</a>)
but Salomons et al. boasts one of the largest sample
sizes in a study of its kind, with 44 dogs and 37
wolves.
Wheat, Bilj & Wynne even praise the large sample size.
However, whether a sample size is large enough 
is dependent on the data-generating assumptions
and decision criteria.</p>

<p>I conducted a simple simulation study of the
domestication and developmental hypotheses
using a variety of sample sizes, simulating 1000 datasets at
each sample size.
The models were fit using MLE for speed. 
Here are the results, where the y axis shows the probability
of correct inference, whether that's a true positive/direct
causal effect or
a true negative/no direct effect. The former is traditionally
known as 'power', and the latter often gets ignored.</p>


<picture>
    <source srcset="/posts/dogs-causal-pointing/static/power-light.png" media="(prefers-color-scheme: light)"/>
    <source srcset="/posts/dogs-causal-pointing/static/power-dark.png" media="(prefers-color-scheme: dark)"/>
    <img src="/posts/dogs-causal-pointing/static/power-light.png"/>
    <figcaption>Sensitivity (power to detect a direct effect) and specificity (power to detect no direct effect) for the domestication and developmental hypotheses across a range of sample sizes.</figcaption>
</picture>

<p>In the left-hand plot, $\beta_S$ is the key parameter
of interest, as it represents the only direct casual 
effect in the domestication hypothesis on point-following.
As can be seen, we need at least 50 (25 dogs, 25 wolves)
subjects to get close
to the traditional 80% threshold of 'ideal power', and as
close to 100 subjects as possible for > 80%.
For the domestication hypothesis, it appears that
Salomons et al. had enough subjects to detect
an effect with relatively high probability.
</p>

<p>The developmental hypothesis results
are less confident. Ideally more than
100 subjects would be needed to achieve
80% power of detecting the true direct
effect of $\beta_W$ on point-following performance, 
and ideally closer to 200 subjects.
Why? Estimating the causal effect
of willingness to approach in the
developmental hypothesis while conditioning on
species and rearing experience is harder
because species and rearing experience reduce
the precision of the effect of willingness.
If you want to learn more, check out the ninth
model from
<a href=https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3689437>
    Cinelli, Forney & Pearl's (2022)</a>
good and bad controls paper.
While we could just exclude species and rearing experience
from that model, entirely, and still estimate the direct
causal effect of $\beta_W$, this would make
disambiguating the
domestication
and developmental hypotheses' predictions.</p>

<p>To conclude, then, I don't think there's sufficient
evidence to distinguish clearly between the
domestication and developmental hypothesis
from Salomons et al. study, and Wheat, Bilj
& Wynne's re-analysis. Researchers need to
decide on the causal assumptions behind these
hypotheses and use those assumptions to dictate
statistical inference.
Someone should re-fit their models including
the rearing experience variable from
Wheat, Bilj & Wynne to test the domestication
hypothesis more clearly, and ideally conduct
a replication study with at least 50, if not
75, wolves and dogs.
While not a simple task, causal modelling
with sufficient power to estimate the
causal effects is the surest way to disentangle
these two hypotheses.
</p>

